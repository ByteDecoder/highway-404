<style>body{margin:0;text-align:center;background:#000;touch-action:none}</style><canvas id=c></canvas><script>(()=>{const e=/iPhone|iPad|Android/i.test(navigator.userAgent);function t(e,t,a){return e>a?0:a>t?1:(a-e)/(t-e)}new(top.AudioContext||webkitAudioContext);const a={},n=e=>localStorage.getItem("2020.highway-404."+e);let i="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANwAAAAFAQMAAAAUpRAlAAAABlBMVEUAAAD///+l2Z/dAAAAAXRSTlMAQObYZgAAAJxJREFUCNcBkQBu/wD/v8//8fhjCMXed5/4xjGP3Ed6X3/c4ACAyAKgAIxhKEIRIGUN5jGMYEjGKlCiyIZQgGMQEIDQBfAA/6Eecv8geQrWMo+cSMakISJBG/7wnPAAjiAIoACMYRhCMSRlCM48lEJIqqoiIkIEQYkiEBAAWRHwAI+f78Hx/+P4xdB8fEcR0Sfc7/hecR3iAICaIKCD0ULSdqTUvwAAAABJRU5ErkJggg==";function h(e,t,a,n,h=0,o=1){const s=5*o,r=e.length*(o+s),c=2===h?r:1===h?r/2:0;[...e].forEach((e,h)=>{t.drawImage(i,5*"abcdefghijklmnopqrstuvwxyz0123456789.:!-%,/#".indexOf(e),0,5,5,a+h*(s+1)-c,n,s,s)})}const o=[38,38,40,40,37,39,37,39,66,65];let s,r,g,d,w,l,A,y,m,p=0,f=0;const u=[[0,6,6],[1,5,5,5],[2,5,5,5],[2,5,5,5],[2,5,5,5],[2,5,5,5],[3,5,5,5],[7,4,7]],x=c.getContext("2d"),v=c.cloneNode(),E=v.getContext("2d");v.width=160,v.height=400;const I=c.cloneNode(),k=I.getContext("2d");I.width=120,I.height=160;const T=I.width-20;let X=0,R=0;const b={hero:{sprites:[{x:0,y:0,w:10,h:20}],speed:{x:100,y:50}},fallingRoad:{sprites:[{x:40,y:0,w:20,h:20},{x:60,y:0,w:20,h:20},{x:80,y:0,w:20,h:20},{x:100,y:0,w:20,h:20},{x:120,y:0,w:20,h:20},{x:140,y:0,w:20,h:20}]},missingRoad:{sprites:[{x:140,y:0,w:20,h:20}]},highwayPanel:{sprites:[{x:0,y:40,w:v.width,h:40}]},highway:{0:[{x:0,y:20,w:20,h:20}],6:[{x:20,y:20,w:20,h:20}],1:[{x:40,y:20,w:20,h:20}],2:[{x:60,y:20,w:20,h:20}],3:[{x:80,y:20,w:20,h:20}],4:[{x:100,y:20,w:20,h:20}],7:[{x:120,y:20,w:20,h:20}],5:[{x:140,y:20,w:20,h:20}],speed:{y:200}}};let C,Y,J,M,K="data:image/png;base64,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",Q=!0;function S(){g=[r=D("hero",I.width/2,v.height-50),D("highwayPanel",0,v.height-I.height+15)],X=0,R=v.height-I.height}function z(){p=0,s=404,w=0,y=0,l=[{distance:808,type:"404",lane:1},{distance:808,type:"404",lane:2},{distance:808,type:"404",lane:3},{distance:808,type:"501",lane:4,length:20},{distance:808,type:"501",lane:5,length:19},{distance:808,type:"501",lane:6,length:18},{distance:1700,type:"200",lane:1},{distance:1720,type:"200",lane:2},{distance:1740,type:"200",lane:3},{distance:1580,type:"503",lane:4,length:20},{distance:1560,type:"503",lane:5,length:19},{distance:1540,type:"503",lane:6,length:18},{distance:2400,type:"100",lane:1},{distance:2400,type:"100",lane:2},{distance:2400,type:"100",lane:3},{distance:2400,type:"100",lane:4},{distance:2400,type:"100",lane:5},{distance:2400,type:"100",lane:6},{distance:3200,type:"503",lane:1,length:20}],A=!1,f=1}function F(e,t){return t.x+t.w>e.x+e.w/4&&e.x+3*e.w/4>t.x&&t.y+t.h>e.y+e.h/4&&e.y+3*e.h/4>t.y}function D(e,t=0,a=0,n=!1){if(b[e]){const i=b[e].sprites[0];return{frame:0,frameTime:0,h:i.h,loopAnimation:n,moveX:0,moveY:0,rotate:0,scale:1,speed:b[e].speed,sprites:b[e].sprites,type:e,w:i.w,x:t,y:a}}return{h:20,type:e,w:20,x:t,y:a}}function N(e){const t=D("fallingRoad",e.x,e.y-e.h);return t.spawn=N,t.spawnTime=s,t}function P(e){if(e.frameTime+=Y,e.frameTime>.1&&(e.frameTime-=.1,(e.sprites.length-1>e.frame||e.loopAnimation)&&(e.frame+=1),e.loopAnimation&&(e.frame%=e.sprites.length),e.dying&&(e.rotate+=.7853981633974483,e.scale-=.1,0>e.scale&&(e.scale=0,e.dying=!1,e.dead=!0))),e.speed&&!e.dying){const t=e.moveX&&e.moveY?.7071067811865476:1;e.x+=e.speed.x*Y*e.moveX*t,e.y+=e.speed.y*Y*e.moveY*t}}function W(e){if(e.sprites){const t=e.sprites[e.frame];k.save(),k.translate(Math.round(e.x-X),Math.round(e.y-R));let a=0,n=0;e.dying?(k.translate(Math.round(e.w/2),Math.round(e.h/2)),k.rotate(e.rotate),a=-e.w/2*e.scale,n=-e.h/2*e.scale):e.moveX&&(k.translate(Math.round(e.w/2),Math.round(e.h/2)),k.rotate(.19634954084936207*e.moveX),a=-e.w/2*e.scale,n=-e.h/2*e.scale),k.drawImage(K,t.x,t.y,t.w,t.h,a,n,t.w*e.scale,t.h*e.scale),k.restore()}else h(e.type,k,Math.round(e.x+10-X),Math.round(e.y+e.h/2-2.5-R),1)}function U(){k.drawImage(v,X,R,I.width,I.height,0,0,I.width,I.height)}function G(){Q&&(M=requestAnimationFrame(G),(()=>{switch(f){case 0:U(),g.forEach(W),h("js13kgames 2020",k,I.width/2,5,1),h(e?"swipe to start":"press any key",k,I.width/2,(I.height+10)/2,1),h("jerome lecomte",k,I.width/2,I.height-10,1),10===p&&h("konami mode on",k,I.width-5,5,2);break;case 1:U(),g.forEach(W),h("highway 404",k,5,5),(()=>{const e=Math.floor(Math.ceil(s)/60),t=Math.ceil(s)-60*e;h(`${e}:${t>9?"":"0"}${t}`,k,I.width-5,5,2)})();break;case 2:U(),g.forEach(W),h("highscore",k,5,5),h(n("highscore")+" sec",k,I.width-5,5,2),h(A?"you arrived!":"you got lost!",k,I.width/2,I.height/3,1)}x.drawImage(I,0,0,I.width,I.height,0,0,c.width,c.height)})(),C=Date.now(),Y=(C-J)/1e3,(()=>{switch(f){case 1:s-=Y,0>s&&(A=!0,f=2),r.dead&&(A=!1,a=Math.max(n("highscore")||13,Math.floor(404-s)),localStorage.setItem("2020.highway-404.highscore",a),f=2),y=r.dying?1-t(0,1.5,r.dyingTime-s):t(0,1.5,404-s),g.forEach(P),w+=(()=>{const e=b.highway.speed.y*Y*y;return R-=e,r.y-=e,0>R&&(R+=v.height-I.height,g.forEach(e=>{e.y+=v.height-I.height})),e})(),20>(e=r).x?e.x=20:e.x>v.width-20-e.w&&(e.x=v.width-20-e.w),R+20>e.y?e.y=R+20:e.y>R+I.height-e.h&&(e.y=R+I.height-e.h),X>0&&X+20>r.x?X=Math.max(0,r.x-20):v.width-I.width>X&&r.x+r.w>X+T&&(X=Math.min(v.width-I.width,r.x+r.w-T)),d=[];const i=new Set;(e=>{l=l.filter(t=>{if(t.distance>w&&w+20>t.distance){e.push(D(t.type,20*t.lane,-20+R));for(let a=1;t.length>=a;a++)e.push(D("missingRoad",20*t.lane,-20*(a+2)+R));return!1}return!0})})(d),(()=>{const e=g.filter(e=>"200"===e.type);g.forEach(t=>{if(t.spawn&&t.spawnTime-s>.083){const a=t.spawn(t);d.push(a),t.spawn=null,e.forEach(e=>{F(a,e)&&(a.spawn=null)})}})})(),g.forEach(e=>{if(e!==r&&!e.triggered&&F(r,e))switch(e.type){case"100":e.triggered=!0,i.add("continue");break;case"200":e.triggered=!0,i.add("road OK");break;case"404":e.triggered=!0,d.push(N({x:e.x,y:e.y+20,h:e.h})),i.add("road not found");break;case"501":e.triggered=!0,i.add("road not implemented");break;case"503":e.triggered=!0,i.add("road unavailable");break;case"fallingRoad":e.frame>e.sprites.length/2&&(e.triggered=!0,r.dying||(r.dying=!0,r.dyingTime=s));break;case"missingRoad":e.triggered=!0,r.dying||(r.dying=!0,r.dyingTime=s)}}),g=d.concat(g),i.forEach(e=>m(e)),g=g.filter(e=>R+I.height+20>e.y)}var e,a})(),J=C)}function B(e){Q=e,Q?(J=Date.now(),G()):cancelAnimationFrame(M)}function O(e){return new Promise(t=>{var a=new Image;a.onload=()=>{t(a)},a.src=e})}onload=async()=>{document.title="Highway 404",onresize(),await(async e=>{i=await e(i)})(O),K=await O(K),m=await(async()=>{let e=(await new Promise((e,t)=>{let a=0,n=setInterval(()=>{a+=1,speechSynthesis.getVoices().length?(e(speechSynthesis.getVoices()),clearInterval(n)):100>a||(t([]),clearInterval(n))},10)})).filter(e=>navigator.language===e.lang||RegExp("^"+navigator.language.split("-")[0]).test(e.lang));if(e.length){const i=(t=e)[(n=t.length-1,Math.floor(Math.random()*(n+1-0)+0))];return e=>{const t=a[e]||(a[e]=new SpeechSynthesisUtterance(e));t.voice=i,speechSynthesis.speak(t)}}var t,n;return()=>{}})(),S(),u.forEach((e,t)=>{let a=v.height;for(;a>0;)e.forEach(e=>{const n=b.highway[e][0];a-=n.h,E.drawImage(K,n.x,n.y,n.w,n.h,t*n.w,a,n.w,n.h)})}),B(!0)},onresize=onrotate=()=>{const e=Math.min(innerWidth/I.width,innerHeight/I.height);c.width=I.width*e,c.height=I.height*e,x.imageSmoothingEnabled=E.imageSmoothingEnabled=k.imageSmoothingEnabled=!1},document.onvisibilitychange=e=>{B(!e.target.hidden)},onkeydown=e=>{if(e.preventDefault(),!e.repeat)switch(f){case 1:switch(e.code){case"ArrowLeft":case"KeyA":case"KeyQ":r.moveX=-1;break;case"ArrowUp":case"KeyW":case"KeyZ":r.moveY=-1;break;case"ArrowRight":case"KeyD":r.moveX=1;break;case"ArrowDown":case"KeyS":r.moveY=1;break;case"KeyP":B(!Q)}}},onkeyup=e=>{switch(f){case 0:e.which!==o[p]||10===p?z():p++;break;case 1:switch(e.code){case"ArrowLeft":case"KeyA":case"KeyQ":case"ArrowRight":case"KeyD":r.moveX=0;break;case"ArrowUp":case"KeyW":case"KeyZ":case"ArrowDown":case"KeyS":r.moveY=0}break;case 2:switch(e.code){case"KeyT":open("https://twitter.com/intent/tweet?text=viral%20marketing%20message%20https%3A%2F%2Fgoo.gl%2Fsome tiny Google url here","_blank");break;default:S(),f=0}}};let j=0,q=0,H=0,L=0;function Z(e){return[e.pageX||e.changedTouches[0].pageX,e.pageY||e.changedTouches[0].pageY]}ontouchstart=onpointerdown=e=>{switch(e.preventDefault(),f){case 1:[H,L]=[j,q]=Z(e)}},ontouchmove=onpointermove=e=>{switch(e.preventDefault(),f){case 1:j&&q&&(([e,t])=>{e>H?(H=e,H-j>30&&(r.moveX=1)):j>e?(j=e,H-j>30&&(r.moveX=-1)):H>e&&r.moveX>0?(j=e,r.moveX=0):e>j&&0>r.moveX&&(H=e,r.moveX=0),t>L?(L=t,L-q>30&&(r.moveY=1)):q>t?(q=t,L-q>30&&(r.moveY=-1)):L>t&&r.moveY>0?(q=t,r.moveY=0):t>q&&0>r.moveY&&(L=t,r.moveY=0)})(Z(e))}},ontouchend=onpointerup=e=>{switch(e.preventDefault(),f){case 0:z();break;case 1:r.moveX=r.moveY=0,j=q=H=L=0;break;case 2:S(),f=0}}})();</script>