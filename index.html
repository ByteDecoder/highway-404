<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1"><style>body{margin:0;text-align:center;background:#000}body,canvas{touch-action:none;user-select:none}</style><canvas id=c></canvas><script>(()=>{const e=/iPhone|iPad|Android/i.test(navigator.userAgent),t=new(top.AudioContext||webkitAudioContext),a=(e=1,t=.05,a=220,n=0,i=0,o=.1,s=0,l=1,h=0,r=0,m=0,c=0,g=0,p=0,y=0,d=0,w=0,A=1,u=0,f=44100,v=99+n*f,x=i*f,T=o*f,b=u*f,I=w*f,k=2*Math.PI,M=(e=>e>0?1:-1),z=v+b+x+T+I,E=(h*=500*k/f**2),X=(a*=(1+2*t*Math.random()-t)*k/f),F=M(y)*k/4,R=0,C=0,D=0,S=0,Y=0,K=0,P=1,Q=[])=>{for(;z>D;Q[D++]=K)++Y>100*d&&(Y=0,K=R*a*Math.sin(C*y*k/f-F),K=M(K=s?s>1?s>2?s>3?Math.sin((K%k)**3):Math.max(Math.min(Math.tan(K),1),-1):1-(2*K/k%2+2)%2:1-4*Math.abs(Math.round(K/k)-K/k):Math.sin(K))*Math.abs(K)**l*e*.3*(v>D?D/v:v+b>D?1-(D-v)/b*(1-A):v+b+x>D?A:z-I>D?(z-D-I)/T*A:0),K=I?K/2+(I>D?0:(z-I>D?1:(D-z)/I)*Q[D-I|0]/2):K),R+=1-p+1e9*(Math.sin(D)+1)%2*p,C+=1-p+1e9*(Math.sin(D)**2+1)%2*p,a+=h+=500*r*k/f**3,P&&++P>c*f&&(a+=m*k/f,X+=m*k/f,P=0),g&&++S>g*f&&(a=X,h=E,S=1,P=P||1);return Q};function n(e,t,a){return 0>a?e:a>1?t:e*(1-a)+t*a}function i(e,t){if(0>=t)return e[0];if(t>=1)return e[e.length-1];const a=Math.floor((e.length-1)*t);return n(e[a],e[Math.ceil((e.length-1)*t)],t*(e.length-1)-a)}const o={},s=(e,t,a="2020.highway-404.")=>localStorage.setItem(a+e,t),l=(e,t="2020.highway-404.")=>localStorage.getItem(t+e);let h="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPoAAAAFCAMAAABb9gHDAAAAAXNSR0IArs4c6QAAAAZQTFRFAAAA////pdmf3QAAAAJ0Uk5TAP9bkSK1AAAA4ElEQVQ4jXVUCQ6DMAyz///pSZD4KB3TUENLbMcJ4F7QQis/gRaY8FkqxCZArzLB7bbASjbvcnIGrTk3LHRt9OzF0zdHMMbn1mQG83qMibE5V+QfcX4zNsCC2dqZT2FITSQI1SG9lG8Fl0KUVwguqo1UeasXFkMBX8o0LSpBwqV0gknaggnjt9VM+hun66yKbMag/OljCb71MDpkaWDveiaibUKZvfYP5z89tJITvIzOEhyNc7ruEoXr5VKOlzzWkZzcnmEYqI58bFG118ec4URAfjvi3ZvD6oqsGUrmZYh/WxsCHSPC1FwAAAAASUVORK5CYII=";function r(e,t,a,n,i=0,o=1){const s=5*o,l=e.length*(o+s),r=2===i?l:1===i?l/2:0;[...e].forEach((e,i)=>{t.drawImage(h,5*"abcdefghijklmnopqrstuvwxyz0123456789.:!-%,/#[]UDLRT".indexOf(e),0,5,5,a+i*(s+1)-r,n,s,s)})}const m=[38,38,40,40,37,39,37,39,66,65];let g,p,y,d,w,A,u,f,v,x,T=0,b=0,I=[{time:2.54,lane:1,type:"103",msg:"road not found"},{time:2.54,lane:2,type:"103",msg:"road not found"},{time:2.54,lane:3,type:"103",msg:"road not found"},{time:2.54,lane:4,type:"103",msg:"road not found"},{time:2.54,lane:5,type:"103",msg:"road not found"},{time:2.54,lane:6,type:"103",msg:"road not found"},{time:2.54,lane:7,type:"103",msg:"road not found"},{time:4.5,lane:1,type:"404"},{time:4.5,lane:2,type:"404"},{time:4.5,lane:3,type:"404"},{time:4.5,lane:4,type:"404"},{time:4.5,lane:5,type:"404"},{time:4.5,lane:6,type:"404"},{time:4.5,lane:7,type:"404"},{time:10,lane:1,type:"404"},{time:10,lane:2,type:"404"},{time:10,lane:3,type:"404"},{time:10,lane:4,type:"404"},{time:10,lane:5,type:"404"},{time:10,lane:6,type:"404"},{time:10,lane:7,type:"404"},{time:15,lane:1,type:"200"},{time:15,lane:2,type:"200"},{time:15,lane:3,type:"200"},{time:15,lane:4,type:"200"},{time:15,lane:5,type:"200"},{time:15,lane:6,type:"200"},{time:15,lane:7,type:"200"},{time:18,lane:2,type:"103",msg:"road unavailable"},{time:18,lane:1,type:"103",msg:"road unavailable"},{time:18,lane:3,type:"103",msg:"road unavailable"},{time:18,lane:4,type:"103",msg:"road unavailable"},{time:18,lane:5,type:"103",msg:"road unavailable"},{time:18,lane:6,type:"103",msg:"road unavailable"},{time:18,lane:7,type:"103",msg:"road unavailable"},{time:20,lane:1,type:"503",length:30},{time:20,lane:7,type:"503",length:30},{time:21,lane:2,type:"503",length:20},{time:21,lane:6,type:"503",length:20},{time:24,lane:4,type:"503",length:50},{time:25,lane:3,type:"503",length:10},{time:25,lane:5,type:"503",length:10},{time:27,lane:1,type:"503",length:20},{time:27,lane:7,type:"503",length:20},{time:33,lane:2,type:"103",msg:"lane change"},{time:33,lane:1,type:"103",msg:"lane change"},{time:33,lane:3,type:"103",msg:"lane change"},{time:33,lane:4,type:"103",msg:"lane change"},{time:33,lane:5,type:"103",msg:"lane change"},{time:33,lane:6,type:"103",msg:"lane change"},{time:33,lane:7,type:"103",msg:"lane change"},{time:35,type:"501",lane:4,length:18},{time:35.5,type:"501",lane:3,length:20},{time:35.5,type:"501",lane:5,length:20},{time:36,type:"501",lane:2,length:20},{time:36,type:"501",lane:6,length:20},{time:37,type:"301",lane:1,redirect:3},{time:37,type:"301",lane:7,redirect:-3},{time:37.2,type:"501",lane:1,length:20},{time:37.2,type:"501",lane:7,length:20},{time:40,type:"501",lane:1,length:8},{time:40,type:"501",lane:7,length:8},{time:40.5,type:"501",lane:2,length:20},{time:40.5,type:"501",lane:6,length:20},{time:41,type:"302",lane:3,redirect:-2},{time:41,type:"302",lane:5,redirect:2},{time:41.2,type:"501",lane:3,length:20},{time:41.2,type:"501",lane:5,length:20},{time:42,type:"302",lane:4,redirect:3},{time:42.2,type:"501",lane:4,length:20},{time:48,lane:1,type:"103",msg:"collect teapots"},{time:48,lane:2,type:"103",msg:"collect teapots"},{time:48,lane:3,type:"103",msg:"collect teapots"},{time:48,lane:4,type:"103",msg:"collect teapots"},{time:48,lane:5,type:"103",msg:"collect teapots"},{time:48,lane:6,type:"103",msg:"collect teapots"},{time:48,lane:7,type:"103",msg:"collect teapots"},{time:50,lane:1,type:"418"},{time:50,lane:4,type:"418"},{time:50,lane:7,type:"418"},{time:52,lane:2,type:"418"},{time:52,lane:6,type:"418"},{time:54,lane:1,type:"418"},{time:54,lane:4,type:"418"},{time:54,lane:7,type:"418"},{time:54.5,lane:1,type:"501",length:10},{time:54.5,lane:4,type:"501",length:26},{time:54.5,lane:7,type:"501",length:10},{time:57,lane:2,type:"404"},{time:57,lane:6,type:"404"},{time:57.1,lane:1,type:"404"},{time:57.1,lane:3,type:"404"},{time:57.1,lane:5,type:"404"},{time:57.1,lane:7,type:"404"},{time:57.3,lane:2,type:"418"},{time:57.3,lane:6,type:"418"},{time:60,lane:1,type:"200"},{time:60,lane:2,type:"200"},{time:60,lane:3,type:"200"},{time:60,lane:5,type:"200"},{time:60,lane:6,type:"200"},{time:60,lane:7,type:"200"},{time:62,lane:1,type:"501",length:20},{time:62,lane:3,type:"501",length:20},{time:62,lane:5,type:"501",length:20},{time:62,lane:7,type:"501",length:20},{time:64,lane:4,type:"418"}],k=[[[,0,77,,,.7,2,.41,,,,,,,,.06],[,0,43,.01,,.3,2,,,,,,,,,.02,.01],[,0,170,.003,,.008,,.97,-35,53,,,,,,.1],[.8,0,270,,,.12,3,1.65,-2,,,,,4.5,,.02],[,0,86,,,,,.7,,,,.5,,6.7,1,.05],[,0,41,,.05,.4,2,0,,,9,.01,,,,.08,.02],[,0,2200,,,.04,3,2,,,800,.02,,4.8,,.01,.1],[.3,0,16,,,.3,3]],[[[1,-1,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33],[3,1,22,,,,,,,,,,,,,,,,,,,,,,,,,,,,24,,,,24,,,,,,,,,,,,,,,,,,,,,,,,22,,22,,22,,,,],[5,-1,21,,,,,,,,,,,,,,,,,,,,,,,,,,,,24,,,,23,,,,,,,,,,,,,,,,,,,,,,,,24,,23,,21,,,,],[,1,21,,,,,,,,,,,,,,,,,,,,,,,,,,,,24,,,,23,,,,,,,,,,,,,,,,,,,,,,,,24,,23,,21,,,,]],[[1,-1,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33],[3,1,24,,,,,,,,27,,,,,,,,,,,,,,,,27,,,,24,,,,24,,,,,,,,27,,,,,,,,,,,,,,,,24,,24,,24,,,,],[5,-1,21,,,,,,,,,,,,,,,,,,,,,,,,,,,,24,,,,23,,,,,,,,,,,,,,,,,,,,,,,,24,,23,,21,,,,],[,1,21,,,,,,,,,,,,,,,,,,,,,,,,,,,,24,,,,23,,,,,,,,,,,,,,,,,,,,,,,,24,,23,,21,,,,],[6,1,,,34,34,34,,,,,,34,34,,,,,34,,,,34,34,,,,,34,,,,34,,,,34,34,34,,,,,,34,,,,,,34,34,,,34,34,,,,,,,,,34,34],[4,1,,,,,,,24,,,,,,24,,24,,,,24,,,,24,,,,,,,,,,,,,,,,24,,,,,,24,,24,,,,24,,,,24,,,,,,,,,,]],[[1,-1,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33,23,23,35,23,23,36,23,23,35,23,23,36,23,23,35,35,23,23,35,23,23,35,23,23,36,23,23,35,23,23,36,36],[5,-1,21,,,19,,,21,,,,,,,,,,21,,,19,,,17,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,],[3,1,24,,,24,,,24,,,,,,,,,,24,,,24,,,24,,,,24.75,24.5,24.26,24.01,24.01,24.01,,,,,25,,,,,,,,25,,,,,,,,25,,,,,,,,25,25,25,25],[4,-1,,,,,,,,,,,,,,,,,,,,,,,,,,,24.75,24.5,24.26,24.01,24.01,24.01,24.01,24,,24,24,,24,24,24,24,,24,24,,24,,24,24,,24,24,,24,24,24,24,,24,24,,24,24],[7,-1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,23,,21,23,,35,,23,,21,23,,35,,35,,23,,21,23,,35,,21,23,,35,,21,23,,,],[6,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,34,36,34,,33,34,34,36,31,36,34,,31,34,32,,33,36,34,,31,34,34,36,33,36,33,,31,,,]],[[1,-1,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33,21,21,33,21,21,33,21,21,33,21,21,33,21,21,33,33,17,17,29,17,17,29,17,17,29,17,17,29,17,17,29,29,17,17,29,17,17,29,17,17,29,17,17,29,17,17,29,29],[4,1,24,24,,24,24,,24,24,24,24,,24,24,,24,,24,24,,24,24,,24,24,24,24,,24,24,,24,24,24,24,,24,24,,24,24,24,,,24,24,,24,,24,24,,24,24,,24,24,24,24,,24,24,,24,24],[7,-1,21,,19,21,,33,,21,,19,21,,33,,33,,21,,19,21,,33,,21,,19,21,,33,,33,,17,,17,17,29,17,17,29,17,,17,17,29,17,17,29,17,,17,17,29,17,17,29,17,,17,17,29,17,17,29],[2,1,,34,34,34,,34,34,34,,34,34,34,,34,34,34,,34,34,34,,34,34,34,,34,34,34,,34,,,,34,34,34,,34,34,34,,34,34,34,,34,34,34,,34,34,34,,34,34,34,,34,34,34,,34,,,],[6,1,,,36,,,,,,36,,36,,,,,,,,36,,,,,,36,,36,,,,,,,,36,,,,,,,,,,,,,,,,36,,,,,,36,,36,,,,,,],[3,1,,,,,25,,,,,,,,25,,,,,,,,25,,,,,,,,25,25,25,25,,,,,25,,,,,25,,,25,,,,,,,,25,,,,,,,,25,25,25,25]],[[1,-1,14,14,26,14,14,26,14,14,26,14,14,26,14,14,26,26,14,14,26,14,14,26,14,14,26,14,14,26,14,14,26,26,17,17,29,17,17,29,17,17,29,17,17,29,17,17,29,29,19,19,31,19,19,31,19,19,31,19,19,31,19,19,31,31],[4,1,24,24,,24,24,,24,24,24,24,,24,24,,24,,24,24,,24,24,,24,24,24,24,,24,24,,24,24,24,24,,24,24,,24,24,24,24,,24,24,,36,,24,24,,24,24,,24,24,24,24,,24,24,,24,24],[7,-1,14,,14,14,26,14,14,26,14,,14,14,26,14,14,26,14,,14,14,26,14,14,26,14,,14,14,26,14,14,26,17,,17,17,29,17,17,29,17,,17,17,29,17,17,29,19,,19,19,31,19,19,31,19,,19,19,31,19,19,31],[2,1,,36,36,36,,36,36,36,,36,36,36,,36,36,36,,36,36,36,,36,36,36,,36,36,36,,36,,,,36,36,36,,36,36,36,,36,36,36,,36,36,36,,36,36,36,,36,36,36,,36,36,36,,36,,,],[3,1,,,,,25,,,,,,,,25,,,,,,,,25,,,,,,,,25,25,25,25,,,,,25,,,,,,,,25,,,,,,,,25,,,,,,,,25,25,25,25],[6,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,34,,,,,,34,,34,,,,,,,,34,,,,,,34,,34,,,,,,]]],[0,1,1,2,3,4,4],,{title:"Depp",instruments:["Instrument 0","Instrument 1","Instrument 2","Instrument 3","Instrument 4","Instrument 5","Instrument 6","Instrument 7"],patterns:["Pattern 0","Pattern 1","Pattern 2","Pattern 3","Pattern 4"]}];const M=c.getContext("2d"),z=c.cloneNode(),E=z.getContext("2d");z.width=180,z.height=400;const X=c.cloneNode(),F=X.getContext("2d");X.width=120,X.height=160;let R="wasd";const C=X.width-50;let D=0,S=0;const Y=[[0,6,6],[1,5,5,5],[2,5,5,5],[2,5,5,5],[2,5,5,5],[2,5,5,5],[2,5,5,5],[3,5,5,5],[7,4,7]],K={hero:{sprites:[{x:0,y:0,w:10,h:20}],speed:{x:100,y:50}},fallingRoad:{sprites:[{x:40,y:0,w:20,h:20},{x:60,y:0,w:20,h:20},{x:80,y:0,w:20,h:20},{x:100,y:0,w:20,h:20},{x:120,y:0,w:20,h:20},{x:140,y:0,w:20,h:20}]},missingRoad:{sprites:[{x:140,y:0,w:20,h:20}]},highwayPanel:{sprites:[{x:0,y:40,w:z.width,h:40}]},highway:{0:[{x:0,y:20,w:20,h:20}],6:[{x:20,y:20,w:20,h:20}],1:[{x:40,y:20,w:20,h:20}],2:[{x:60,y:20,w:20,h:20}],3:[{x:80,y:20,w:20,h:20}],4:[{x:100,y:20,w:20,h:20}],7:[{x:120,y:20,w:20,h:20}],5:[{x:140,y:20,w:20,h:20}],speed:{y:160}}};let P,Q,J,U,N="data:image/png;base64,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",W=!0;function O(){K.hero.sprites[0].x+=10,I=I.concat([{time:53,type:"429",lane:3},{time:53,type:"429",lane:5},{time:61,type:"429",lane:3},{time:61,type:"429",lane:5}])}function G(){d=[y=L("hero",X.width/2,z.height-50),L("highwayPanel",0,z.height-X.height+15),L("highwayPanel",160,z.height-X.height+15)],D=0,S=z.height-X.height}function B(){T=0,g=404,p=0,distance=0,A=!1,(()=>{const e=I.map(e=>({...e,distance:e.time*K.highway.speed.y}));w=[],e.forEach(e=>{switch(w.push(L(e.type,20*e.lane,-e.distance+S)),e.type){case"103":w[w.length-1].msg=e.msg;break;case"301":case"302":w[w.length-1].redirect=e.redirect;break;case"501":case"503":for(let t=1;e.length>=t;t++)w.push(L("missingRoad",20*e.lane,-e.distance-20*(t+1)+S))}}),d=w.concat(d)})(),b=1,$()}function q(e,t){return t.x+t.w>e.x+e.w/4&&e.x+3*e.w/4>t.x&&t.y+t.h>e.y+e.h/4&&e.y+3*e.h/4>t.y}function L(e,t=0,a=0,n=!1){if(K[e]){const i=K[e].sprites[0];return{frame:0,frameTime:0,h:i.h,loopAnimation:n,moveX:0,moveY:0,rotate:0,scale:1,speed:K[e].speed,sprites:K[e].sprites,type:e,w:i.w,x:t,y:a}}return{h:20,type:e,w:20,x:t,y:a}}function j(e){const t=L("fallingRoad",e.x,e.y-e.h);return t.spawn=j,t.spawnTime=g,t}function H(e){if(e.frameTime+=Q,e.frameTime>.1&&(e.frameTime-=.1,(e.sprites.length-1>e.frame||e.loopAnimation)&&(e.frame+=1),e.loopAnimation&&(e.frame%=e.sprites.length),e.dying&&(e.rotate+=.7853981633974483,e.scale-=.1,0>e.scale&&(e.scale=0,e.dying=!1,e.dead=!0))),y.speedTime&&y.speedTime-g>5&&(y.speedTime=0),e.translateTo){const t=(e.translateTime-g)/e.translateDuration;e.x=n(e.translateFrom,e.translateTo,t),e.scale=i([1,1.2,1.6,1.75,1.6,1.25,1],t),t>1&&(e.translateTo=e.translateFrom=e.translateTime=e.translateDuration=void 0)}else if(e.speed&&!e.dying){const t=e.moveX&&e.moveY?.7071067811865476:1;e.x+=e.speed.x*Q*e.moveX*t,e.y+=e.speed.y*Q*e.moveY*t}}function V(){return 10*Math.floor(404-g)+418*p}function Z(){const e=l("highscore")||13,t=Math.max(e,V());s("highscore",t),s("OS13kTrophy,🏅,Highway 404,Highscore",t,"")}function $(){var e;_(),1===b&&(e=k,x=((...e)=>{let a=t.createBufferSource(),n=t.createBuffer(e.length,e[0].length,44100);return e.map((e,t)=>n.getChannelData(t).set(e)),a.buffer=n,a.connect(t.destination),a.start(),a})(...e),x.loop=!0)}function _(){x&&(x.stop(),x=null)}function ee(){M.drawImage(X,0,0,X.width,X.height,0,0,c.width,c.height)}function te(e){if(e.y>=S-40)if(e.sprites){const t=e.sprites[e.frame];F.save(),F.translate(Math.round(e.x-D),Math.round(e.y-S));let a=0,n=0;if(e.dying)F.translate(Math.round(e.w/2),Math.round(e.h/2)),F.rotate(e.rotate),a=-e.w/2*e.scale,n=-e.h/2*e.scale;else if(e.translateTo||e.moveX){const t=e.translateTo?e.translateTo-e.translateFrom>0?1:-1:e.moveX;F.translate(Math.round(e.w/2),Math.round(e.h/2)),F.rotate(.19634954084936207*t),a=-e.w/2*e.scale,n=-e.h/2*e.scale}F.drawImage(N,t.x,t.y,t.w,t.h,a,n,t.w*e.scale,t.h*e.scale),F.restore()}else r(e.type,F,Math.round(e.x+10-D),Math.round(e.y+e.h/2-2.5-S),1)}function ae(){W&&(U=requestAnimationFrame(ae),(()=>{switch(F.drawImage(z,D,S,X.width,X.height,0,0,X.width,X.height),d.forEach(te),b){case 0:r("js13kgames 2020",F,X.width/2,5,1),r("collect teapots",F,X.width/2,X.height/2-10,1),r("for extra points",F,X.width/2,X.height/2-2,1),r(e?"swipe to steer":R+"/ULDR to steer",F,X.width/2,X.height/2+15,1),r("jerome lecomte",F,X.width/2,X.height-10,1);break;case 1:r("score",F,5,5),r(""+V(),F,X.width-5,5,2),(()=>{const e=Math.floor(Math.ceil(g)/60),t=Math.ceil(g)-60*e;r(`time ${e}:${t>9?"":"0"}${t}`,F,5,X.height-10)})(),r("teapot "+p,F,X.width-5,X.height-10,2),y.speedTime&&r(5-Math.floor(y.speedTime-g)+" sec",F,X.width/2,X.height/2,1),f&&r(u,F,X.width/2,X.height/2,1);break;case 2:r("score",F,5,15),r(""+V(),F,X.width-5,15,2),r("highscore",F,5,5),r(l("highscore"),F,X.width-5,5,2),r(A?"you arrived!":"you got lost!",F,X.width/2,X.height/2-3,1),e||r("[t]weet your score",F,X.width/2,X.height-20,1),r(e?"tap to restart":"[space] to restart",F,X.width/2,X.height-10,1)}ee()})(),P=Date.now(),Q=(P-J)/1e3,(()=>{switch(b){case 1:g-=Q,0>g&&(A=!0,Z(),_(),b=2),y.dead&&(A=!1,Z(),_(),b=2),f-g>3&&(f=0),d.forEach(H),(()=>{let e;const t=K.highway.speed.y;e=y.dying?n(t,0,(y.dyingTime-g)/1.5):n(0,t,(404-g)/1.5),y.speedTime&&(e=i([1,.25,.25,.25,.25,1].map(e=>t*e),(y.speedTime-g)/5)),S-=e*Q,y.y-=e*Q,0>S&&(S+=z.height-X.height,d.forEach(e=>{e.y+=z.height-X.height}))})(),20>(e=y).x?e.x=20:e.x>z.width-20-e.w&&(e.x=z.width-20-e.w),S+20>e.y?e.y=S+20:e.y>S+X.height-e.h&&(e.y=S+X.height-e.h),D>0&&D+50>y.x?D=Math.max(0,y.x-50):z.width-X.width>D&&y.x+y.w>D+C&&(D=Math.min(z.width-X.width,y.x+y.w-C)),w=[];const t=new Set;(()=>{const e=d.filter(e=>"200"===e.type);d.forEach(t=>{if(t.spawn&&t.spawnTime-g>.1){const a=t.spawn(t);w.push(a),t.spawn=null,e.forEach(e=>{q(a,e)&&(a.spawn=null)})}})})();let a=!1;y.translateTo||(d.forEach(e=>{if(e!==y&&!e.triggered&&q(y,e))switch(e.triggered=!0,e.type){case"103":f=g,u=e.msg;break;case"200":t.add("road OK");break;case"301":case"302":t.add("301"===e.type?"lane moved":"temporary lane redirect"),y.translateFrom=y.x,y.translateTo=y.x+20*e.redirect,y.translateTime=g,y.translateDuration=Math.abs(.25*e.redirect);break;case"404":w.push(j({x:e.x,y:e.y+20,h:e.h})),t.add("road not found");break;case"418":p++,t.add("extra points");break;case"429":t.add("speed limiting"),y.speedTime=g;break;case"501":t.add("road not implemented");break;case"503":t.add("road unavailable");break;case"fallingRoad":e.triggered=!1,y.dying||y.dead||(y.scale=1-.1*(e.frame+1),a=!0),e.frame>e.sprites.length/2&&(e.triggered=!0,y.dying||(y.dying=!0,y.dyingTime=g));break;case"missingRoad":y.dying||(y.dying=!0,y.dyingTime=g)}}),a||y.dying||y.dead||(y.scale=1)),d=w.concat(d),t.forEach(e=>v(e)),d=d.filter(e=>S+X.height+20>e.y)}var e})(),J=P)}function ne(e){W=e,W?(J=Date.now(),ae()):cancelAnimationFrame(U)}function ie(e){return new Promise(t=>{var a=new Image;a.onload=()=>{t(a)},a.src=e})}onload=async()=>{document.title="Highway 404",onresize(),await(async e=>{h=await e(h)})(ie),N=await ie(N),r("loading...",F,X.width/2,X.height/2,1),ee(),v=await(async()=>{let e=(await new Promise((e,t)=>{let a=0,n=setInterval(()=>{a+=1,speechSynthesis.getVoices().length?(e(speechSynthesis.getVoices()),clearInterval(n)):100>a||(t([]),clearInterval(n))},10)})).filter(e=>navigator.language===e.lang||RegExp("^"+navigator.language.split("-")[0]).test(e.lang));if(e.length){const n=(t=e)[(a=t.length-1,Math.floor(Math.random()*(a+1-0)+0))];return e=>{const t=o[e]||(o[e]=new SpeechSynthesisUtterance(e));t.voice=n,speechSynthesis.speak(t)}}var t,a;return()=>{}})(),[k]=[k].map(e=>((e,t,n,i=125)=>{let o,s,l,h,r,m,c,g,p,y,d,w,A,u,f,v,x=[],T=[],b=[],I=0,k=1,M={},z=44100/i*60>>2;for(;k;I++)x=[k=g=d=A=0],n.map((i,d)=>{for(c=t[i][I]||[0,0,0],k|=!!t[i][I],f=A+(t[i][0].length-2-!g)*z,s=2,h=A;c.length+(d==n.length-1)>s;g=++s){for(r=c[s],p=y!=(c[0]||0)|r|0,l=0;z>l&&g;l++>z-99&&p?w+=(1>w)/99:0)m=(1-w)*x[u++]/2||0,T[h]=(T[h]||0)+m*v-m,b[h]=(b[h++]||0)+m*v+m;r&&(w=r%1,v=c[1]||0,(r|=0)&&(x=M[[y=c[u=0]||0,r]]=M[[y,r]]||(o=[...e[y]],o[2]*=2**((r-12)/12),a(...o))))}A=f});return[T,b]})(...e)),G(),Y.forEach((e,t)=>{let a=z.height;for(;a>0;)e.forEach(e=>{const n=K.highway[e][0];a-=n.h,E.drawImage(N,n.x,n.y,n.w,n.h,t*n.w,a,n.w,n.h)})}),(e=>{function t(){document.monetization.removeEventListener("monetizationstart",t),e()}document.monetization&&("started"===document.monetization.state?t():"pending"===document.monetization.state&&document.monetization.addEventListener("monetizationstart",t))})(O),/^fr/i.test(navigator.language)&&(R="zqsd"),ne(!0)},onresize=onrotate=()=>{const e=Math.min(innerWidth/X.width,innerHeight/X.height);c.width=X.width*e,c.height=X.height*e,M.imageSmoothingEnabled=E.imageSmoothingEnabled=F.imageSmoothingEnabled=!1},document.onvisibilitychange=e=>{ne(!e.target.hidden),W?$():_()},onkeydown=e=>{if(e.preventDefault(),!e.repeat)switch(b){case 1:switch(e.code){case"ArrowLeft":case"KeyA":case"KeyQ":y.moveX=-1;break;case"ArrowUp":case"KeyW":case"KeyZ":y.moveY=-1;break;case"ArrowRight":case"KeyD":y.moveX=1;break;case"ArrowDown":case"KeyS":y.moveY=1;break;case"KeyP":ne(!W)}}},onkeyup=e=>{switch(b){case 0:e.which!==m[T]||10===T?B():(T++,10===T&&O());break;case 1:switch(e.code){case"ArrowLeft":case"KeyA":case"KeyQ":case"ArrowRight":case"KeyD":y.moveX=0;break;case"ArrowUp":case"KeyW":case"KeyZ":case"ArrowDown":case"KeyS":y.moveY=0}break;case 2:switch(e.code){case"KeyT":open(`https://twitter.com/intent/tweet?text=I%20survived%20${Math.floor(404-g)}%20seconds${p>0?" and collected "+p+" teapot"+(p>1?"s":""):""}%20in%20Highway%20404%20by%20%40herebefrogs%20for%20%23js13k%202020%0Ahttps%3A%2F%2Fbit.ly%2Fhgw-404`,"_blank");break;default:G(),b=0}}};let oe=0,se=0,le=0,he=0;function re(e){return[e.pageX||e.changedTouches[0].pageX,e.pageY||e.changedTouches[0].pageY]}ontouchstart=onpointerdown=e=>{switch(e.preventDefault(),b){case 1:[le,he]=[oe,se]=re(e)}},ontouchmove=onpointermove=e=>{switch(e.preventDefault(),b){case 1:oe&&se&&(([e,t])=>{e>le?(le=e,y.moveX=n(0,1,(le-oe)/30)):oe>e?(oe=e,y.moveX=-n(0,1,(le-oe)/30)):le>e&&y.moveX>0?(oe=e,y.moveX=0):e>oe&&0>y.moveX&&(le=e,y.moveX=0),t>he?(he=t,y.moveY=n(0,1,(he-se)/30)):se>t?(se=t,y.moveY=-n(0,1,(he-se)/30)):he>t&&y.moveY>0?(se=t,y.moveY=0):t>se&&0>y.moveY&&(he=t,y.moveY=0)})(re(e))}},ontouchend=onpointerup=e=>{switch(e.preventDefault(),b){case 0:B();break;case 1:y.moveX=y.moveY=0,oe=se=le=he=0;break;case 2:G(),b=0}}})();</script>